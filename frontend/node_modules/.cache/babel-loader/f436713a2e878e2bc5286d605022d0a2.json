{"ast":null,"code":"export default {\n  name: 'PostAShare',\n\n  data() {\n    return {\n      success: \"\",\n      message: \"\",\n      //message d'erreur\n      ShareText: {\n        type: String,\n        default: \"No comment\"\n      },\n      file: \"\",\n      ShareFormHidden: {\n        type: Boolean,\n        default: true\n      }\n    };\n  },\n\n  methods: {\n    displayForm() {\n      this.ShareFormHidden = false;\n    },\n\n    displayGoTo() {\n      this.ShareFormHidden = true;\n      this.file = null;\n    },\n\n    checkForm() {\n      if (document.getElementById(\"ShareText\") || document.getElementById(\"Media\")) {\n        document.getElementById(\"ShareBtn\").disabled = false;\n      } else document.getElementById(\"ShareBtn\").disabled = true;\n    },\n\n    uploadImage($event) {\n      this.file = URL.createObjectURL($event.target.files[0]);\n    },\n\n    Share() {\n      const Token = JSON.parse(sessionStorage.getItem(\"Token\"));\n      const ShareToBePosted = document.getElementById(\"ShareToBePosted\");\n      const Body = new FormData(ShareToBePosted);\n      fetch(\"http://localhost:3000/api/shares\", {\n        method: 'POST',\n        headers: {\n          \"Accept\": \"*/*\",\n          // \"Content-Type\": \"multipart/form-data\", \n          \"Authorization\": \"Bearer \" + Token\n        },\n        body: Body,\n        mode: \"cors\"\n      }).then(response => {\n        if (response.status == 201) {\n          this.success = true;\n          this.message = \"Partage en ligne.\";\n          this.ShareFormHidden = true;\n          this.$router.push({\n            name: 'wall'\n          });\n          this.$router.go(0); // history.go(0);\n        } else {\n          response.json().then(json => {\n            this.success = false;\n            console.log(json);\n            this.message = json.error || json.message;\n            return this.message;\n          });\n        }\n      }).catch(() => {\n        this.success = false;\n        this.message = `Le serveur ne répond pas ! Veuillez réessayer ultérieurement`;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAsFI,eAAe;AACbA,MAAI,EAAE,YADO;;AAEbC,MAAI,GAAG;AACL,WAAO;AACDC,aAAO,EAAE,EADR;AAEDC,aAAM,EAAG,EAFR;AAEY;AACbC,eAAS,EAAE;AACTC,YAAI,EAAEC,MADG;AAETC,eAAO,EAAE;AAFA,OAHV;AAMDC,UAAG,EAAG,EANL;AAODC,qBAAc,EAAG;AACfJ,YAAI,EAAEK,OADS;AAEfH,eAAO,EAAE;AAFM;AAPhB,KAAP;AAWD,GAdY;;AAebI,SAAO,EAAE;AAELC,eAAW,GAAE;AACX,WAAKH,eAAL,GAAuB,KAAvB;AACD,KAJI;;AAKLI,eAAW,GAAE;AACX,WAAKJ,eAAL,GAAuB,IAAvB;AACA,WAAKD,IAAL,GAAY,IAAZ;AACD,KARI;;AAULM,aAAS,GAAG;AACF,UAAIC,QAAQ,CAACC,cAAT,CAAwB,WAAxB,KAAwCD,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CAA5C,EACE;AACFD,gBAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCC,QAApC,GAA+C,KAA/C;AACA,OAHA,MAIKF,QAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCC,QAApC,GAA+C,IAA/C;AACd,KAhBI;;AAkBLC,eAAW,CAACC,MAAD,EAAS;AACV,WAAKX,IAAL,GAAYY,GAAG,CAACC,eAAJ,CAAoBF,MAAM,CAACG,MAAP,CAAcC,KAAd,CAAoB,CAApB,CAApB,CAAZ;AACT,KApBI;;AAsBLC,SAAK,GAAG;AAEE,YAAMC,KAAI,GAAIC,IAAI,CAACC,KAAL,CAAWC,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAAX,CAAd;AACA,YAAMC,eAAc,GAAIf,QAAQ,CAACC,cAAT,CAAwB,iBAAxB,CAAxB;AAEA,YAAMe,IAAG,GAAI,IAAIC,QAAJ,CAAaF,eAAb,CAAb;AAEAG,WAAK,CAAC,kCAAD,EAAqC;AAChCC,cAAM,EAAE,MADwB;AAEhCC,eAAO,EAAE;AACL,oBAAS,KADJ;AAEL;AACA,2BAAiB,YAAYV;AAHxB,SAFuB;AAOhCW,YAAI,EAAEL,IAP0B;AAQhCM,YAAG,EAAI;AARyB,OAArC,CAAL,CAUCC,IAVD,CAUOC,QAAD,IAAc;AAEV,YAAIA,QAAQ,CAACC,MAAT,IAAmB,GAAvB,EAA4B;AAClB,eAAKtC,OAAL,GAAc,IAAd;AACA,eAAKC,OAAL,GAAe,mBAAf;AACA,eAAKM,eAAL,GAAuB,IAAvB;AACA,eAAKgC,OAAL,CAAaC,IAAb,CAAkB;AAAE1C,gBAAI,EAAE;AAAR,WAAlB;AACA,eAAKyC,OAAL,CAAaE,EAAb,CAAgB,CAAhB,EALkB,CAMlB;AACV,SAPA,MAOO;AACGJ,kBAAQ,CAACK,IAAT,GACCN,IADD,CACQM,IAAD,IAAU;AACjB,iBAAK1C,OAAL,GAAc,KAAd;AACA2C,mBAAO,CAACC,GAAR,CAAYF,IAAZ;AACA,iBAAKzC,OAAL,GAAeyC,IAAI,CAACG,KAAL,IAAeH,IAAI,CAACzC,OAAnC;AACA,mBAAO,KAAKA,OAAZ;AACC,WAND;AAOV;AACT,OA5BD,EA6BC6C,KA7BD,CA6BQ,MAAM;AACJ,aAAK9C,OAAL,GAAc,KAAd;AACA,aAAKC,OAAL,GAAgB,8DAAhB;AACT,OAhCD;AAiCV;;AA9DK;AAfI,CAAf","names":["name","data","success","message","ShareText","type","String","default","file","ShareFormHidden","Boolean","methods","displayForm","displayGoTo","checkForm","document","getElementById","disabled","uploadImage","$event","URL","createObjectURL","target","files","Share","Token","JSON","parse","sessionStorage","getItem","ShareToBePosted","Body","FormData","fetch","method","headers","body","mode","then","response","status","$router","push","go","json","console","log","error","catch"],"sourceRoot":"","sources":["/Users/stefan/Library/Mobile Documents/com~apple~CloudDocs/08 WEB ET SITES/P7/frontend/src/components/PostAShare.vue"],"sourcesContent":["<template>\n    <section class = \"container\">\n      <div class=\"btn-div\" id=\"ShareAccess\" v-show=\"ShareFormHidden\">\n        <button type=\"button\" \n                class=\"btn\" \n                @click=\"displayForm()\" \n                id=\"GoToShare\" \n                value=\"Partager\">\n                Et vous,<br/> que voulez-vous partager?\n        </button>\n      </div>\n      <div class = \"formSection\" id=\"ShareForm\" v-show=\"!ShareFormHidden\" >\n          <div class=\"please\">\n            <h2 > Votre partage </h2>\n          </div>\n          <div class = \"formDiv\">\n                    <form     \n                              type=\"multipart/form-data\"\n                              method=\"POST\" \n                              name=\"form\" \n                              id=\"ShareToBePosted\"\n                              \n                              @submit = \"Share\"\n                              class=\"formulaire\">\n\n                               <!--Le Media -->\n                              <div class=\"formLine\">\n                                        <label    \n                                                  for=\"Media\" \n                                                  class=\"label\">Votre image, votre GIF</label>\n                                        <input    class=\"input\"\n                                                  form=\"ShareToBePosted\" \n                                                  @input=\"checkForm\"\n                                                  @change=\"uploadImage($event)\"\n                                                  type=\"file\"\n                                                  accept=\"image/png, image/jpg, image/jpeg, image/png, image/gif\"\n                                                  multiple\n                                                  id=\"Media\" \n                                                  name=\"file\" \n                                                 >\n                              </div>\n\n                              <div id=\"formImagePreview\">\n                                        <img v-if=\"file\" :src=\"file\" />\n                              </div>\n                              \n                              <!--Le Share-->\n                               <div class=\"formLine\">\n                                        <label    \n                                                  for=\"ShareText\" \n                                                  class=\"label\">Votre texte</label>\n                                        <textarea class=\"bigtextarea textarea input\"\n                                                  form=\"ShareToBePosted\" \n                                                  type=\"textarea\"\n                                                  @input=\"checkForm\"\n                                                 \n                                                  placeholder= \"...\"\n                                                  autofocus\n                                                  id=\"ShareText\"\n                                                  name=\"ShareText\"\n                                                  ></textarea>\n                              </div>\n                              \n                              <!-- A ÉTUDIER -->\n                              <!-- https://css-tricks.com/auto-growing-inputs-textareas/ -->\n                              <!-- https://stackoverflow.com/questions/2803880/is-there-a-way-to-get-a-textarea-to-stretch-to-fit-its-content-without-using-php -->\n                              <!-- https://www.skymac.org/Admin-Dev/article-5d6989e5-Astuce-HTML-Javascript-Creer-un-textarea-a-la-hauteur-auto-adaptative-1.htm -->\n\n\n                              <div class=\"btn-div\">\n                                        <button type=\"button\" class=\"btn\" @click=\"displayGoTo()\" id=\"CancelBtn\">Annuler</button>\n                                        <button type=\"button\" class=\"btn\" @click=\"Share()\" id=\"ShareBtn\" disabled>Partager</button>\n                              </div>\n       \n                    </form>\n\n                    <div class=\"add-div\" v-show=\"success===false\">\n                      <p id=\"erreur\"> Echec du partage : {{message}} </p>\n                    </div>\n\n          </div>\n      </div>\n    </section>\n</template>\n\n<script>\n    export default {\n      name: 'PostAShare',\n      data() {\n        return {\n              success: \"\",\n              message :\"\", //message d'erreur\n              ShareText: {\n                type: String,\n                default: \"No comment\"},\n              file :\"\",\n              ShareFormHidden :{\n                type: Boolean,\n                default: true }\n        }\n      },\n      methods: {\n\n          displayForm(){\n            this.ShareFormHidden = false\n          },\n          displayGoTo(){\n            this.ShareFormHidden = true;\n            this.file = null\n          },\n\n          checkForm() {\n                    if (document.getElementById(\"ShareText\") || document.getElementById(\"Media\")\n                    ) {\n                    document.getElementById(\"ShareBtn\").disabled = false;\n                    }\n                    else document.getElementById(\"ShareBtn\").disabled = true;\n          },\n\n          uploadImage($event) {\n                    this.file = URL.createObjectURL($event.target.files[0]);\n          },\n\n          Share() {\n\n                    const Token = JSON.parse(sessionStorage.getItem(\"Token\"));\n                    const ShareToBePosted = document.getElementById(\"ShareToBePosted\");\n                    \n                    const Body = new FormData(ShareToBePosted);\n                    \n                    fetch(\"http://localhost:3000/api/shares\", {\n                              method: 'POST',\n                              headers: {\n                                  \"Accept\":\"*/*\",\n                                  // \"Content-Type\": \"multipart/form-data\", \n                                  \"Authorization\": \"Bearer \" + Token\n                              },\n                              body: Body,\n                              mode : \"cors\"})\n\n                    .then((response) => {\n\n                              if (response.status == 201) { \n                                        this.success= true;\n                                        this.message = \"Partage en ligne.\";\n                                        this.ShareFormHidden = true;\n                                        this.$router.push({ name: 'wall' });\n                                        this.$router.go(0);\n                                        // history.go(0);\n                              } else {\n                                        response.json ()\n                                        .then ((json) => {\n                                        this.success= false;\n                                        console.log(json);\n                                        this.message = json.error ||  json.message ;\n                                        return this.message\n                                        })\n                              }\n                    })\n                    .catch (() => {\n                              this.success= false;\n                              this.message = `Le serveur ne répond pas ! Veuillez réessayer ultérieurement`;\n                    })         \n          }               \n      }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n\n    #ShareAccess{\n      margin-top: 10px\n    }\n\n    #formImagePreview {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    #formImagePreview img {\n      max-width: 100%;\n      max-height: 500px;\n    }\n\n</style>"]},"metadata":{},"sourceType":"module"}