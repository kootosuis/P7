{"ast":null,"code":"export default {\n  name: 'UserSignUpComp',\n\n  data() {\n    return {\n      message: \"\" //message d'erreur\n\n    };\n  },\n\n  methods: {\n    checkForm() {\n      if (document.getElementById(\"UserName\").checkValidity() && document.getElementById(\"UserFirstname\").checkValidity() && document.getElementById(\"UserEmail\").checkValidity() && document.getElementById(\"UserPassword\").checkValidity()) {\n        document.getElementById(\"UserSignupBtn\").disabled = false;\n      } else {\n        document.getElementById(\"UserSignupBtn\").disabled = true;\n      }\n    },\n\n    signUp(e) {\n      event.preventDefault();\n      const UserName = document.getElementById(\"UserName\").value;\n      const UserFirstname = document.getElementById(\"UserFirstname\").value;\n      const UserEmail = document.getElementById(\"UserEmail\").value;\n      const UserPassword = document.getElementById(\"UserPassword\").value;\n      const UserPresentation = document.getElementById(\"UserPresentation\").value;\n      const UserDepartement = document.getElementById(\"UserDepartement\").value;\n      const UserRole = document.getElementById(\"UserRole\").value;\n      const User = {\n        \"UserName\": UserName,\n        \"UserFirstname\": UserFirstname,\n        \"UserEmail\": UserEmail,\n        \"UserDepartement\": UserDepartement,\n        \"UserPresentation\": UserPresentation,\n        \"UserRole\": UserRole,\n        \"UserPassword\": UserPassword,\n        //--- la ligne suivante permet de remplir le modèle ----//\n        //--- c'est le premier administrateur qui autorisera le second à le devenir----///\n        \"UserHabilitation\": false\n      };\n      fetch(\"http://localhost:3000/api/auth/signup\", {\n        method: 'POST',\n        body: JSON.stringify(User),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        mode: \"cors\"\n      }).then(response => {\n        if (response.status == 201) {\n          response.json().then(() => {\n            this.success = true;\n            this.message = \"Inscription validée.\";\n            const UserShortCutEmail = User.UserEmail;\n            const UserShortCutPassword = User.UserPassword;\n            const UserShortCutHabilitation = User.UserHabilitation;\n            const UserShortCut = {\n              \"UserEmail\": UserShortCutEmail,\n              \"UserPassword\": UserShortCutPassword,\n              \"UserHabilitation\": UserShortCutHabilitation\n            };\n            fetch(\"http://localhost:3000/api/auth/login\", {\n              method: 'POST',\n              body: JSON.stringify(UserShortCut),\n              headers: {\n                \"Content-Type\": \"application/json\"\n              },\n              mode: \"cors\"\n            }).then(response => {\n              if (response.status == 200) {\n                response.json().then(response => {\n                  this.success = true;\n                  this.message = \"Authentification effectuée.\";\n                  sessionStorage.setItem(\"UserId\", JSON.stringify(response.UserId));\n                  sessionStorage.setItem(\"Token\", JSON.stringify(response.token));\n                  sessionStorage.setItem(\"UserHabilitation\", JSON.stringify(response.UserHabilitation));\n                  setTimeout(this.$router.push({\n                    name: 'wall'\n                  }), 3000);\n                });\n              } else {\n                response.json().then(json => {\n                  this.success = false;\n                  console.log(json);\n                  this.message = json.error;\n                });\n              }\n            }).catch(() => {\n              this.success = false;\n              this.message = `veuillez réessayer ultérieurement`;\n            });\n          });\n        } else {\n          response.json().then(json => {\n            this.success = false;\n            console.log(json);\n            this.message = json.error.errors[0].message;\n          });\n        }\n      }).catch(() => {\n        this.success = false;\n        this.message = `veuillez réessayer ultérieurement`;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["name","data","message","methods","checkForm","document","getElementById","checkValidity","disabled","signUp","e","event","preventDefault","UserName","value","UserFirstname","UserEmail","UserPassword","UserPresentation","UserDepartement","UserRole","User","fetch","method","body","JSON","stringify","headers","mode","then","response","status","json","success","UserShortCutEmail","UserShortCutPassword","UserShortCutHabilitation","UserHabilitation","UserShortCut","sessionStorage","setItem","UserId","token","setTimeout","$router","push","console","log","error","catch","errors"],"sourceRoot":"","sources":["/Users/stefan/Library/Mobile Documents/com~apple~CloudDocs/08 WEB ET SITES/P7/frontend/src/components/UserSignUpComp.vue"],"sourcesContent":["<template>\n    <section class = \"container\">\n      <div class = \"formSection\">\n\n          <div class=\"please\">\n            <h2 > Veuillez renseigner le formulaire pour créer votre compte </h2>\n          </div>\n\n          <div class = \"formDiv\">\n                    <form     class=\"formulaire\"\n                              method=\"POST\" \n                              name=\"form\" \n                              id=\"form\" \n                              @submit = \"signUp\">\n                              \n\n                              <!--Le Nom-->\n                              <div class=\"formLine\">\n                                        <label\n                                                  for=\"UserName\" \n                                                  class=\"label\">Nom <span class=\"asterisque\">*</span></label>\n                                        <input    class=\"input\" \n                                                  @input = \"checkForm\"    \n                                                  type=\"text\" \n                                                  placeholder=\"Entrez votre nom.\"\n                                                  id=\"UserName\" \n                                                  name=\"UserName\" \n                                                  required=\"required\">\n                              </div>\n\n                              <!--Le Prénom-->\n                              <div class=\"formLine\">\n                                        <label \n                                                  for=\"UserFirstname\" \n                                                  class=\"label\">Prénom <span class=\"asterisque\">*</span></label>\n                                        <input    class=\"input\" \n                                                  @input = \"checkForm\"  \n                                                  type=\"text\" \n                                                  placeholder=\"Entrez votre prénom.\" \n                                                  id=\"UserFirstname\" \n                                                  name=\"UserFirstname\" \n                                                  required=\"required\">\n                              </div>\n\n                              <!--L'Email'-->\n                               <div class=\"formLine\">\n                                        <label    \n                                                  for=\"UserEmail\" \n                                                  class=\"label\">Email <span class=\"asterisque\">*</span></label>\n                                        <input    class=\"input\"\n                                                  @input = \"checkForm\"    \n                                                  type=\"email\" \n                                                  placeholder=\"Entrez une adresse mail valide.\" \n                                                  id=\"UserEmail\"\n                                                  name=\"UserEmail\" \n                                                  required=\"\">\n                              </div>\n\n                              <!--La Présentation-->\n                              <div class=\"formLine\">\n                                        <label \n                                                  for=\"UserPresentation\" \n                                                  class=\"label\">Présentation</label>\n                                        <textarea class=\"smalltextarea input\"\n                                                  type=\"textarea\" \n                                                  placeholder=\"Si vous le souhaitez, vous pouvez vous présenter...\" \n                                                  id=\"UserPresentation\" \n                                                  name=\"UserPresentation\" \n                                                  ></textarea>\n                              </div>\n\n                              <!--Le Service-->\n                              <div class=\"formLine\">\n                                        <label \n                                                  for=\"UserDepartement\" \n                                                  class=\"label\">Service <span class=\"asterisque\">*</span></label>\n                                        \n                                                  <select class=\"input\"\n                                                            id=\"UserDepartement\" \n                                                            name=\"UserDepartement\" \n                                                        \n                                                            required=\"required\">\n                                                                      <option value=\"...\">...</option>\n                                                                      <option value=\"communication\">communication</option>\n                                                                      <option value=\"administration\">administration</option>\n                                                                      <option value=\"siège\">siège</option>\n                                                                      <option value=\"R&amp;D\">R&amp;D</option>\n                                                                      <option value=\"magasin 1\">magasin 1</option>\n                                                                      <option value=\"magasin 2\">magasin 2</option>\n                                                                      <option value=\"etc.\">etc.</option>\n                                                  </select>\n                                                           \n                                        \n                              </div>\n\n                              <!--Le Role-->\n                              <div class=\"formLine\">\n                                        <label    \n                                        for=\"UserRole\" \n                                                  class=\"label\">Rôle</label>\n                                        <textarea class=\"smalltextarea input\"\n                                                  type=\"textarea\" \n                                                  placeholder=\"Quel est votre rôle dans l'entreprise ?\" \n                                                  id=\"UserRole\" \n                                                  name=\"UserRole\"></textarea>\n                              </div>\n\n                              <!--Le Mot de passe -->\n                              <div class=\"formLine\">\n                                        <label    \n                                                  for=\"UserPassword\" \n                                                  class=\"label\">Mot de passe <span class=\"asterisque\">*</span></label>\n                                                  \n                                        <input    class=\"input\"\n                                                  @input = \"checkForm\"    \n                                                  type=\"text\" \n                                                  placeholder=\"N'oubliez pas de noter votre mot de passe.\" \n                                                  id=\"UserPassword\" \n                                                  name=\"UserPassword\" \n                                                  required=\"required\" \n                                                  maxlength=\"30\">\n                              </div>\n\n                              <!-- Avertissement -->\n                              <div class=\"formLine\">\n                                <div class=\"label\"></div>\n                                <p class=\"hint input\">Le mot de passe doit contenir au minimum 8 caractères,\n                                                      dont une majuscule, une minuscule, un chiffre et un caractère spécial.</p>\n                              </div>\n                              \n                              <div class=\"asterisque\" style=\"text-align:right\"> * Champs requis </div>\n\n                              <div class=\"btn-div\">\n                                        <!-- ICI  --> \n                                        <!-- lancer un modal? mettre le texte en lowercase ? un bouton annuler ? -->\n                                        <input type=\"submit\"  class=\"btn\" id=\"UserSignupBtn\" value=\"S'inscrire\" disabled>        \n                              </div>\n                    </form>\n\n                    \n                    <div class=\"add-div\" v-show=\"success===false\">\n                      <p id=\"erreur\" > Echec de l'inscription : {{message}} </p>\n                    </div>\n\n                    <div class=\"add-div\" v-show=\"success===true\">\n                      <p id=\"erreur\" > {{message}} </p>\n                    </div>\n\n                    <div id=\"no-account\" class=\"add-div\">\n                      <p> Déjà un compte ? <router-link class=\"no-account-link\" to=\"../login\">S'authentifier</router-link> </p>\n                    </div>\n          </div>\n       </div>\n    </section>\n</template>\n\n<script>\nexport default {\n  name: 'UserSignUpComp',\n  data() {\n    return {\n    message :\"\", //message d'erreur\n    }\n  },\n  methods: {\n\n    checkForm() {\n      if (document.getElementById(\"UserName\").checkValidity() \n      && document.getElementById(\"UserFirstname\").checkValidity() \n      && document.getElementById(\"UserEmail\").checkValidity()\n      && document.getElementById(\"UserPassword\").checkValidity()) {\n        document.getElementById(\"UserSignupBtn\").disabled = false;\n      }\n      else {document.getElementById(\"UserSignupBtn\").disabled = true}\n    },\n\n    signUp(e) {\n\n     event.preventDefault()\n\n      const UserName = document.getElementById(\"UserName\").value\n      const UserFirstname = document.getElementById(\"UserFirstname\").value\n      const UserEmail = document.getElementById(\"UserEmail\").value\n      const UserPassword = document.getElementById(\"UserPassword\").value\n      const UserPresentation = document.getElementById(\"UserPresentation\").value\n      const UserDepartement= document.getElementById(\"UserDepartement\").value\n      const UserRole = document.getElementById(\"UserRole\").value;\n      \n      const User = { \"UserName\": UserName,\n                     \"UserFirstname\": UserFirstname,\n                     \"UserEmail\": UserEmail,\n                     \"UserDepartement\": UserDepartement,\n                     \"UserPresentation\": UserPresentation,\n                     \"UserRole\": UserRole,\n                     \"UserPassword\": UserPassword,\n                     //--- la ligne suivante permet de remplir le modèle ----//\n                     //--- c'est le premier administrateur qui autorisera le second à le devenir----///\n                     \"UserHabilitation\":false,\n\n      }\n\n      fetch(\"http://localhost:3000/api/auth/signup\", {\n          method: 'POST',\n          body: JSON.stringify(User),\n          headers: {\"Content-Type\": \"application/json\" },\n          mode :\"cors\"\n      })\n      .then((response) => {\n                    if (response.status == 201) { \n                              response.json()\n                              .then(() => {\n                                    this.success= true;\n                                    this.message = \"Inscription validée.\";\n\n                                    const UserShortCutEmail = User.UserEmail\n                                    const UserShortCutPassword = User.UserPassword\n                                    const UserShortCutHabilitation = User.UserHabilitation\n                                    const UserShortCut = { \"UserEmail\": UserShortCutEmail, \n                                                           \"UserPassword\": UserShortCutPassword,\n                                                           \"UserHabilitation\": UserShortCutHabilitation\n                                                            }\n\n                                    fetch(\"http://localhost:3000/api/auth/login\", {\n                                              method: 'POST',\n                                              body: JSON.stringify(UserShortCut),\n                                              headers: {\"Content-Type\": \"application/json\" },\n                                              mode :\"cors\"\n                                    })\n                                    .then((response) => {\n                                              if (response.status == 200) { \n                                                        response.json()\n                                                        .then((response) => {\n                                                            this.success= true;\n                                                            this.message = \"Authentification effectuée.\";\n                                                            sessionStorage.setItem(\"UserId\", JSON.stringify(response.UserId));\n                                                            sessionStorage.setItem(\"Token\", JSON.stringify(response.token));\n                                                            sessionStorage.setItem(\"UserHabilitation\", JSON.stringify(response.UserHabilitation));\n                                                            setTimeout(this.$router.push({ name: 'wall' }), 3000);\n                                                        })\n                                              } else {\n                                                        response.json ()\n                                                        .then ((json) => {\n                                                        this.success= false;\n                                                        console.log(json);\n                                                        this.message = json.error;\n                                                        })\n                                              }\n                                    })\n                                    .catch (() => {\n                                              this.success= false;\n                                              this.message = `veuillez réessayer ultérieurement`;\n                                    })\n                              })\n                    } else {\n                              response.json ()\n                              .then ((json) => {\n                              this.success= false;\n                              console.log(json);\n                              this.message = json.error.errors[0].message;\n                              })\n                    }\n       })\n      .catch (() => {\n              this.success= false;\n              this.message = `veuillez réessayer ultérieurement`;\n      })         \n    }  \n  }\n}             \n  \n</script>\n\n<style lang=\"scss\" scoped>\n\n#no-account {\n  padding: 1.5rem;\n  font-size : 1.5rem;\n}\n.no-account-link{\n  font-weight: 500;\n  font-size : 2rem;\n  \n}\n\n</style>"]},"metadata":{},"sourceType":"module"}